[
  {
    "path": "posts/welcome/",
    "title": "Welcome to Guy Sutton",
    "description": "Welcome to my new blog. Get excited for lots of R stats!",
    "author": [
      {
        "name": "Guy Sutton",
        "url": {}
      }
    ],
    "date": "2020-10-29",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2020-10-29T15:42:00+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-10-29-automated-plotting-of-species-accumulation-curves-by-group/",
    "title": "Plotting species accumulation curves using ggplot",
    "description": "A slow and steady introduction",
    "author": [
      {
        "name": "Guy Sutton",
        "url": {}
      }
    ],
    "date": "2020-10-29",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\nToday, we are going to look at how to compute and plot species accumulation curves (hereafter ‘SAC’) using the amazing vegan package. SAC’s are extremely popular in ecological analyses as they allow us to evaluate whether performing additional sampling is required to record all of the insect species associated with a particular plant species, for example.\r\nIn this session, we are going to cover the most basic SAC - observed richness. Observed species richness (hereafter ‘S’) simply tells us:\r\n* how many species we have recorded, to date, and\r\n* whether more surveys could yield new additional species.\r\n* But, it DOES NOT tell us how many species could be in the community (i.e. we cannot extrapolate) - we will cover how to extrapolate species richness in a later post.\r\nLet’s load in a typical community richness dataset (species abundance matrix). This dataset represents the insect community associated with the shurb, Lycium ferocissimum, in South Africa.\r\n\r\n\r\n# Load required packages \r\nif (!require(\"pacman\")) install.packages(\"pacman\")\r\npacman::p_load(tidyverse, \r\n               tidyr, \r\n               janitor,\r\n               vegan)\r\n\r\n# Read in data \r\nsp_comm <- readr::read_csv(\"https://raw.githubusercontent.com/guysutton/CBC_coding_club/master/data_raw/species_abundance_matrix_ex.csv\") %>%\r\n  # Clean column names \r\n  janitor::clean_names()\r\n\r\n# Check data entry \r\ndplyr::glimpse(sp_comm)\r\n\r\n\r\nRows: 56\r\nColumns: 56\r\n$ provinces                                   <chr> \"Eastern Cape...\r\n$ climatic_zones                              <chr> \"Cfb\", \"Cfb\",...\r\n$ site                                        <chr> \"EC1\", \"EC1\",...\r\n$ season                                      <dbl> 1, 2, 1, 2, 1...\r\n$ haplotype                                   <dbl> 5, 5, 5, 5, 5...\r\n$ cleta_eckloni                               <dbl> 23, 8, 11, 0,...\r\n$ pseudambonea_capeni_schuhistes_lekkersingia <dbl> 4, 28, 0, 0, ...\r\n$ acanthocoris_spinosus                       <dbl> 1, 0, 0, 0, 0...\r\n$ antestiopsis_thunbergii                     <dbl> 1, 0, 0, 0, 0...\r\n$ cassida_distinguenda                        <dbl> 0, 3, 0, 0, 0...\r\n$ epilachna_sp_1                              <dbl> 0, 4, 0, 0, 0...\r\n$ cleta_sp_1                                  <dbl> 0, 0, 0, 0, 0...\r\n$ cleta_sp_2                                  <dbl> 0, 0, 0, 0, 0...\r\n$ exochomus_flavipes                          <dbl> 0, 0, 0, 0, 0...\r\n$ scymnus_sp                                  <dbl> 0, 0, 0, 0, 0...\r\n$ cheilomenes_lunata                          <dbl> 0, 0, 0, 0, 0...\r\n$ cheilomenes_sulphurea                       <dbl> 0, 0, 0, 0, 0...\r\n$ cf_nephus_sp                                <dbl> 0, 0, 0, 0, 0...\r\n$ chnootriba_sp                               <dbl> 0, 0, 0, 0, 0...\r\n$ oenopia_cinctella                           <dbl> 0, 0, 0, 0, 0...\r\n$ hippodamia_variegate                        <dbl> 0, 0, 0, 0, 0...\r\n$ cassida_melanophthalma                      <dbl> 0, 0, 0, 0, 0...\r\n$ cassida_reticulipennis                      <dbl> 0, 0, 0, 0, 0...\r\n$ macetes_sp                                  <dbl> 0, 0, 0, 0, 0...\r\n$ cryptocephalus_nr_liturellus                <dbl> 0, 0, 0, 0, 0...\r\n$ epitrix_sp                                  <dbl> 0, 0, 0, 0, 0...\r\n$ chrysomelidae_sp                            <dbl> 0, 0, 0, 0, 0...\r\n$ sulcobruchus_longipennis                    <dbl> 0, 0, 0, 0, 0...\r\n$ monolepta_bioculata                         <dbl> 0, 0, 0, 0, 0...\r\n$ eurytomidae_sp                              <dbl> 0, 0, 0, 0, 0...\r\n$ pachycnema_sp                               <dbl> 0, 0, 0, 0, 0...\r\n$ scarabaeidae_sp                             <dbl> 0, 0, 0, 0, 0...\r\n$ neoplatygaster_serieturberculata            <dbl> 0, 8, 0, 0, 0...\r\n$ sciobius_sp                                 <dbl> 0, 0, 0, 0, 0...\r\n$ lixini_sp                                   <dbl> 0, 0, 0, 0, 0...\r\n$ beaufortiana_cornuta                        <dbl> 0, 0, 0, 0, 1...\r\n$ pentatomidae_sp                             <dbl> 0, 0, 0, 0, 0...\r\n$ apalochrus_sp                               <dbl> 0, 0, 0, 0, 0...\r\n$ hylomela_sexpunctata                        <dbl> 0, 0, 0, 0, 1...\r\n$ anthripidae_sp                              <dbl> 0, 0, 0, 0, 1...\r\n$ cenaeus_carnifex                            <dbl> 0, 0, 0, 0, 0...\r\n$ thrips_simplex                              <dbl> 0, 0, 0, 0, 0...\r\n$ ceratitis_sp                                <dbl> 0, 0, 0, 0, 0...\r\n$ brachymeria_sp                              <dbl> 0, 0, 0, 0, 0...\r\n$ syrphidae_sp                                <dbl> 0, 0, 0, 0, 0...\r\n$ cicadidae_sp                                <dbl> 0, 0, 0, 0, 0...\r\n$ apis_mellifera                              <dbl> 0, 0, 0, 0, 0...\r\n$ pteromalidae_sp                             <dbl> 0, 0, 0, 0, 0...\r\n$ chrysopidae_sp                              <dbl> 0, 0, 0, 0, 0...\r\n$ pamphagidae_sp                              <dbl> 0, 0, 0, 0, 0...\r\n$ amphipsocidae_sp                            <dbl> 0, 0, 0, 0, 0...\r\n$ diptera_sp                                  <dbl> 0, 0, 0, 0, 0...\r\n$ hymenoptera_sp                              <dbl> 0, 0, 0, 0, 0...\r\n$ decapotoma_lunata                           <dbl> 0, 0, 0, 0, 0...\r\n$ pyrrhocordae_sp_1                           <dbl> 0, 0, 0, 0, 0...\r\n$ mylabris_oculata                            <dbl> 0, 0, 0, 0, 0...\r\n\r\nNow it is time to compute our species accumulation curve. To do this, we will use the poolaccum function from the vegan R package. Notice the first few columns are site description variables (i.e. not species abundances). We need to remove these columns, and only input the columns containing species abundances.\r\n\r\n\r\nsac_raw <- sp_comm %>%\r\n  # Remove site decsription variables \r\n  dplyr::select(-c(provinces, climatic_zones, site, season, haplotype)) %>%\r\n  # Compute SAC\r\n  vegan::poolaccum(.)\r\n\r\n\r\n\r\nWe now need to extract our observed species richness (S) estimates.\r\nN - No. of surveys (i.e. survey effort)\r\nS - Observed species richness\r\nlower2.5 - lower 95% confidence interval of S\r\nupper97.5 - upper 95% confidence interval of S\r\n\r\n\r\n# Extract observed richness (S) estimate \r\nobs <- data.frame(summary(sac_raw)$S, check.names = FALSE)\r\ncolnames(obs) <- c(\"N\", \"S\", \"lower2.5\", \"higher97.5\", \"std\")\r\nhead(obs)\r\n\r\n\r\n  N     S lower2.5 higher97.5      std\r\n1 3  7.36    1.475     15.050 3.494642\r\n2 4  9.55    2.000     19.050 4.154528\r\n3 5 11.29    3.000     20.050 4.386147\r\n4 6 13.01    5.000     21.050 4.457419\r\n5 7 14.63    6.475     22.525 4.409941\r\n6 8 16.04    6.950     24.000 4.355236\r\n\r\nFinally, we can plot the desired species accumulation curve. Ultimately, we would like to see our S estimate and the 95% confidence intervals reach an asymptote (flat line) on the y-axis. This would indicate that performing additional surveys is highly unlikely to yield additional insects on the plant we have surveyed.\r\n\r\n\r\nobs %>%\r\n  ggplot(data = ., aes(x = N,\r\n                       y = S)) +\r\n  # Add confidence intervals\r\n  geom_ribbon(aes(ymin = lower2.5,\r\n                  ymax = higher97.5),\r\n              alpha = 0.5,\r\n              colour = \"gray70\") +\r\n  # Add observed richness line \r\n  geom_line() +\r\n  labs(x = \"No. of surveys\",\r\n       y = \"Observed richness\",\r\n       subtitle = \"More surveys are required to find all the insects on this plant\")\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2020-10-29-automated-plotting-of-species-accumulation-curves-by-group/automated-plotting-of-species-accumulation-curves-by-group_files/figure-html5/curve-1.png",
    "last_modified": "2020-10-29T21:07:21+02:00",
    "input_file": "automated-plotting-of-species-accumulation-curves-by-group.utf8.md"
  }
]
